<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Digital Krishi Officer</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f0fdf4; /* Light green background */
    }
    .chat-container {
      max-width: 960px;
      margin: 0 auto;
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    .sidebar {
      background-color: #047857; /* Dark green */
      color: white;
      min-width: 250px;
      display: flex;
      flex-direction: column;
      padding: 1.5rem;
      border-radius: 1rem;
      margin: 1rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .chat-area {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      background-color: #ffffff;
      border-radius: 1rem;
      margin: 1rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .chat-messages {
      flex-grow: 1;
      overflow-y: auto;
      padding: 1rem;
    }
    .message {
      max-width: 80%;
      padding: 0.75rem 1rem;
      border-radius: 0.75rem;
      margin-bottom: 0.75rem;
      line-height: 1.5;
    }
    .message.bot {
      background-color: #e0f2fe; /* Light blue */
      color: #0c4a6e;
      align-self: flex-start;
      border-top-left-radius: 0;
    }
    .message.user {
      background-color: #10b981; /* Green */
      color: #ffffff;
      align-self: flex-end;
      border-top-right-radius: 0;
    }
    .chat-input-area {
      padding: 1rem;
      border-top: 1px solid #e5e7eb;
      background-color: #f9fafb;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      border-radius: 0 0 1rem 1rem;
    }
    #user-input {
      flex-grow: 1;
      border: 1px solid #d1d5db;
      padding: 0.75rem 1rem;
      border-radius: 0.75rem;
    }
    .mic-btn, .send-btn {
      background-color: #059669; /* Darker green */
      color: white;
      padding: 0.75rem;
      border-radius: 0.75rem;
      transition: background-color 0.2s;
    }
    .mic-btn:hover, .send-btn:hover {
      background-color: #047857;
    }
    .login-container, .loader {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: #f0fdf4;
    }
    .loader img {
      animation: spin 2s linear infinite;
    }
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .quick-ask-btn {
      background-color: #ecfdf5;
      color: #065f46;
      border: 1px solid #34d399;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    .quick-ask-btn:hover {
      background-color: #d1fae5;
    }
    .profile-box {
      background-color: #064e3b;
      padding: 1rem;
      border-radius: 0.75rem;
      margin-bottom: 1rem;
    }
    .file-upload-container {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .file-upload-container input[type="file"] {
      display: none;
    }
    .file-upload-label {
      background-color: #059669;
      color: white;
      padding: 0.75rem 1rem;
      border-radius: 0.75rem;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    .file-upload-label:hover {
      background-color: #047857;
    }
    @media (min-width: 768px) {
      .chat-container {
        flex-direction: row;
      }
      .sidebar {
        min-width: 250px;
        flex-shrink: 0;
      }
    }
  </style>
</head>
<body class="bg-gray-100 flex items-center justify-center">

  <!-- Login/Auth Screen -->
  <div id="login-container" class="login-container p-8 rounded-xl shadow-lg bg-white">
    <div class="text-center mb-6">
      <h2 class="text-3xl font-bold text-gray-800">Krishi Bot</h2>
      <p class="text-sm text-gray-500 mt-1">Digital Agriculture Assistant</p>
    </div>
    <input type="text" id="username" placeholder="Username" class="mb-4 p-3 w-72 rounded-lg border focus:outline-none focus:ring-2 focus:ring-green-500">
    <input type="password" id="password" placeholder="Password" class="mb-6 p-3 w-72 rounded-lg border focus:outline-none focus:ring-2 focus:ring-green-500">
    <button onclick="login()" class="w-72 py-3 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700 transition-colors">Login</button>
  </div>

  <!-- Main Chat Interface -->
  <div id="main-interface" class="chat-container hidden">

    <!-- Sidebar -->
    <div class="sidebar">
      <div class="profile-box">
        <h3 id="profile-name" class="font-bold text-lg">Welcome, Farmer</h3>
        <p id="profile-location" class="text-sm">Location: Kerala, India</p>
      </div>
      <h2 class="font-bold text-xl mb-4">üå± Krishi Bot</h2>
      <button onclick="newChat()" class="py-2 px-3 rounded-lg text-left hover:bg-green-800 transition-colors">New Chat</button>
      <hr class="my-4 border-gray-600">
      <h3 class="font-semibold text-gray-300 text-sm mb-2">Quick Questions</h3>
      <button onclick="quickAsk('pests')" class="quick-ask-btn mb-2">Pests & Diseases</button>
      <button onclick="quickAsk('weather')" class="quick-ask-btn mb-2">Weather Forecast</button>
      <button onclick="quickAsk('subsidies')" class="quick-ask-btn mb-2">Government Subsidies</button>
      <button onclick="quickAsk('market')" class="quick-ask-btn mb-2">Market Trends</button>
      <button onclick="quickAsk('escalation')" class="quick-ask-btn mb-2 bg-red-500 text-white">Escalate Query</button>
    </div>

    <!-- Chat Area -->
    <div class="chat-area">
      <div class="chat-messages" id="chat-box">
        <div class="message bot">
          <p>‡¥®‡¥Æ‡¥∏‡µç‡¥ï‡¥æ‡¥∞‡¥Ç! ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥°‡¥ø‡¥ú‡¥ø‡¥±‡µç‡¥±‡µΩ ‡¥ï‡µÉ‡¥∑‡¥ø ‡¥ì‡¥´‡µÄ‡¥∏‡µº ‡¥Ü‡¥£‡µç ‡¥û‡¥æ‡µª. ‡¥µ‡¥ø‡¥≥‡¥ï‡µæ, ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥•, ‡¥ï‡µÄ‡¥ü‡¥ô‡µç‡¥ô‡µæ ‡¥é‡¥®‡µç‡¥®‡¥ø‡¥µ‡¥Ø‡µÜ‡¥ï‡µç‡¥ï‡µÅ‡¥±‡¥ø‡¥ö‡µç‡¥ö‡µÅ‡¥≥‡µç‡¥≥ ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥∏‡¥Ç‡¥∂‡¥Ø‡¥ô‡µç‡¥ô‡µæ ‡¥ö‡µã‡¥¶‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡¥µ‡µÅ‡¥®‡µç‡¥®‡¥§‡¥æ‡¥£‡µç.</p>
          <p class="mt-2 text-xs text-gray-500"><i>(Hello! I am your Digital Krishi Officer. You can ask me your doubts about crops, weather, pests, etc.)</i></p>
        </div>
      </div>
      <div class="chat-input-area">
        <select id="language-select" class="px-2 py-2 rounded-lg border-2 border-gray-300 bg-gray-50 focus:outline-none">
          <option value="ml">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</option>
          <option value="en">English</option>
        </select>
        <button id="mic-btn" class="mic-btn">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a4 4 0 11-8 0 4 4 0 018 0z" />
          </svg>
        </button>
        <label for="file-upload" class="file-upload-label cursor-pointer flex items-center justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
          </svg>
          <span class="ml-2">Add Photo</span>
        </label>
        <input id="file-upload" type="file" accept="image/*" />
        <input id="user-input" type="text" placeholder="Type your question..." class="flex-1 p-3 rounded-lg border-2 border-gray-300 focus:outline-none focus:ring-2 focus:ring-green-500">
        <button id="send-btn" class="send-btn">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
          </svg>
        </button>
      </div>
    </div>
  </div>

  <script>
    // --- Front-end UI Logic ---
    const loginContainer = document.getElementById('login-container');
    const mainInterface = document.getElementById('main-interface');
    const chatBox = document.getElementById('chat-box');
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');
    const micBtn = document.getElementById('mic-btn');
    const fileUpload = document.getElementById('file-upload');
    const languageSelect = document.getElementById('language-select');

    // Simulated data and responses
    const simulatedResponses = {
      'ml': {
        'pests': "‡¥µ‡¥æ‡¥¥‡¥Ø‡¥ø‡µΩ ‡¥ï‡¥æ‡¥£‡µÅ‡¥®‡µç‡¥® ‡¥á‡¥≤‡¥™‡µç‡¥™‡µÅ‡¥≥‡µç‡¥≥‡¥ø ‡¥∞‡µã‡¥ó‡¥Ç ‡¥§‡¥ü‡¥Ø‡¥æ‡µª ‡¥ï‡µã‡¥™‡µç‡¥™‡µº ‡¥ì‡¥ï‡µç‡¥∏‡¥ø‡¥ï‡µç‡¥≤‡µã‡¥±‡µà‡¥°‡µç ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï. ‡¥ï‡µÇ‡¥ü‡µÅ‡¥§‡µΩ ‡¥µ‡¥ø‡¥µ‡¥∞‡¥ô‡µç‡¥ô‡µæ‡¥ï‡µç‡¥ï‡µç ‡¥Ö‡¥ü‡µÅ‡¥§‡µç‡¥§‡µÅ‡¥≥‡µç‡¥≥ ‡¥ï‡µÉ‡¥∑‡¥ø‡¥≠‡¥µ‡¥®‡µÅ‡¥Æ‡¥æ‡¥Ø‡¥ø ‡¥¨‡¥®‡µç‡¥ß‡¥™‡µç‡¥™‡µÜ‡¥ü‡µÅ‡¥ï.",
        'weather': "‡¥Ö‡¥ü‡µÅ‡¥§‡µç‡¥§ 24 ‡¥Æ‡¥£‡¥ø‡¥ï‡µç‡¥ï‡µÇ‡¥±‡¥ø‡¥®‡µÅ‡¥≥‡µç‡¥≥‡¥ø‡µΩ ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µç‡¥∞‡¥¶‡µá‡¥∂‡¥§‡µç‡¥§‡µç ‡¥®‡µá‡¥∞‡¥ø‡¥Ø ‡¥Æ‡¥¥‡¥ï‡µç‡¥ï‡µç ‡¥∏‡¥æ‡¥ß‡µç‡¥Ø‡¥§‡¥Ø‡µÅ‡¥£‡µç‡¥ü‡µç.",
        'subsidies': "2024-25 ‡¥∏‡¥æ‡¥Æ‡µç‡¥™‡¥§‡µç‡¥§‡¥ø‡¥ï ‡¥µ‡µº‡¥∑‡¥§‡µç‡¥§‡¥ø‡µΩ ‡¥§‡µÜ‡¥ô‡µç‡¥ô‡µÅ‡¥ï‡µÉ‡¥∑‡¥ø‡¥ï‡µç‡¥ï‡µç ‡¥™‡µÅ‡¥§‡¥ø‡¥Ø ‡¥∏‡¥¨‡µç‡¥∏‡¥ø‡¥°‡¥ø‡¥ï‡µæ ‡¥™‡µç‡¥∞‡¥ñ‡µç‡¥Ø‡¥æ‡¥™‡¥ø‡¥ö‡µç‡¥ö‡¥ø‡¥ü‡µç‡¥ü‡µÅ‡¥£‡µç‡¥ü‡µç.",
        'market': "‡¥á‡¥®‡µç‡¥®‡µç ‡¥µ‡¥æ‡¥¥‡¥™‡µç‡¥™‡¥¥‡¥§‡µç‡¥§‡¥ø‡¥®‡µç‡¥±‡µÜ ‡¥µ‡¥ø‡¥≤ ‡¥ï‡¥ø‡¥≤‡µã‡¥ó‡µç‡¥∞‡¥æ‡¥Æ‡¥ø‡¥®‡µç ‚Çπ25 ‡¥Ü‡¥£‡µç. ‡¥Ö‡¥§‡µç ‡¥Ö‡¥ü‡µÅ‡¥§‡µç‡¥§ ‡¥Ü‡¥¥‡µç‡¥ö ‡¥µ‡µº‡¥¶‡µç‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡µª ‡¥∏‡¥æ‡¥ß‡µç‡¥Ø‡¥§‡¥Ø‡µÅ‡¥£‡µç‡¥ü‡µç.",
        'escalation': "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥ö‡µã‡¥¶‡µç‡¥Ø‡¥Ç ‡¥™‡µç‡¥∞‡¥æ‡¥¶‡µá‡¥∂‡¥ø‡¥ï ‡¥ï‡µÉ‡¥∑‡¥ø ‡¥ì‡¥´‡µÄ‡¥∏‡µº‡¥ï‡µç‡¥ï‡µç ‡¥ï‡µà‡¥Æ‡¥æ‡¥±‡¥ø‡¥Ø‡¥ø‡¥ü‡µç‡¥ü‡µÅ‡¥£‡µç‡¥ü‡µç. ‡¥â‡¥ü‡µª‡¥§‡¥®‡µç‡¥®‡µÜ ‡¥í‡¥∞‡µÅ ‡¥™‡µç‡¥∞‡¥§‡¥ø‡¥ï‡¥∞‡¥£‡¥Ç ‡¥™‡µç‡¥∞‡¥§‡µÄ‡¥ï‡µç‡¥∑‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï.",
        'fallback': "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥ö‡µã‡¥¶‡µç‡¥Ø‡¥Ç ‡¥µ‡µç‡¥Ø‡¥ï‡µç‡¥§‡¥Æ‡¥≤‡µç‡¥≤. ‡¥¶‡¥Ø‡¥µ‡¥æ‡¥Ø‡¥ø ‡¥µ‡µÄ‡¥£‡µç‡¥ü‡µÅ‡¥Ç ‡¥ö‡µã‡¥¶‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï.",
      },
      'en': {
        'pests': "To prevent leaf spot disease in bananas, use Copper Oxychloride. For more details, contact your local Krishi Bhavan.",
        'weather': "There is a chance of light rain in your area within the next 24 hours.",
        'subsidies': "New subsidies have been announced for coconut farming in the 2024-25 fiscal year.",
        'market': "The price of bananas today is ‚Çπ25 per kilogram. It is expected to increase next week.",
        'escalation': "Your query has been escalated to a local agri officer. Please expect a response soon.",
        'fallback': "Sorry, I don't understand your question. Please try again.",
      }
    };

    function login() {
      // In a real app, this would be an API call for authentication.
      // We're just simulating the UI change for now.
      loginContainer.classList.add('hidden');
      mainInterface.classList.remove('hidden');
    }

    function addMessage(text, sender) {
      const msgDiv = document.createElement('div');
      msgDiv.classList.add('message', sender, 'rounded-xl', 'p-3', 'shadow-md');
      msgDiv.textContent = text;
      chatBox.appendChild(msgDiv);
      chatBox.scrollTop = chatBox.scrollHeight;
    }

    async function handleMessage() {
      const message = userInput.value.trim();
      const language = languageSelect.value;
      if (!message) return;

      addMessage(message, 'user');
      userInput.value = '';

      // SIMULATION: Simulating a delay for the AI response
      await new Promise(resolve => setTimeout(resolve, 1000));

      const query = message.toLowerCase();
      let responseText = simulatedResponses[language].fallback;

      // Simple keyword matching for a simulated response
      if (query.includes('pests') || query.includes('‡¥ï‡µÄ‡¥ü‡¥Ç')) {
        responseText = simulatedResponses[language].pests;
      } else if (query.includes('weather') || query.includes('‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥•')) {
        responseText = simulatedResponses[language].weather;
      } else if (query.includes('subsidy') || query.includes('‡¥∏‡¥¨‡µç‡¥∏‡¥ø‡¥°‡¥ø')) {
        responseText = simulatedResponses[language].subsidies;
      } else if (query.includes('market') || query.includes('‡¥µ‡¥ø‡¥™‡¥£‡¥ø')) {
        responseText = simulatedResponses[language].market;
      }

      addMessage(responseText, 'bot');
    }

    // Event Listeners
    sendBtn.addEventListener('click', handleMessage);
    userInput.addEventListener('keydown', (event) => {
      if (event.key === 'Enter') {
        handleMessage();
      }
    });

    function newChat() {
      chatBox.innerHTML = `
        <div class="message bot">
          <p>‡¥®‡¥Æ‡¥∏‡µç‡¥ï‡¥æ‡¥∞‡¥Ç! ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥°‡¥ø‡¥ú‡¥ø‡¥±‡µç‡¥±‡µΩ ‡¥ï‡µÉ‡¥∑‡¥ø ‡¥ì‡¥´‡µÄ‡¥∏‡µº ‡¥Ü‡¥£‡µç ‡¥û‡¥æ‡µª. ‡¥µ‡¥ø‡¥≥‡¥ï‡µæ, ‡¥ï‡¥æ‡¥≤‡¥æ‡¥µ‡¥∏‡µç‡¥•, ‡¥ï‡µÄ‡¥ü‡¥ô‡µç‡¥ô‡µæ ‡¥é‡¥®‡µç‡¥®‡¥ø‡¥µ‡¥Ø‡µÜ‡¥ï‡µç‡¥ï‡µÅ‡¥±‡¥ø‡¥ö‡µç‡¥ö‡µÅ‡¥≥‡µç‡¥≥ ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥∏‡¥Ç‡¥∂‡¥Ø‡¥ô‡µç‡¥ô‡µæ ‡¥ö‡µã‡¥¶‡¥ø‡¥ï‡µç‡¥ï‡¥æ‡¥µ‡µÅ‡¥®‡µç‡¥®‡¥§‡¥æ‡¥£‡µç.</p>
          <p class="mt-2 text-xs text-gray-500"><i>(Hello! I am your Digital Krishi Officer. You can ask me your doubts about crops, weather, pests, etc.)</i></p>
        </div>
      `;
    }

    function quickAsk(type) {
      const language = languageSelect.value;
      const response = simulatedResponses[language][type];
      addMessage(response, 'bot');
    }

    // Voice Input Integration
    micBtn.addEventListener('click', () => {
      // Check for browser support
      if ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = new SpeechRecognition();

        // Set language based on user selection
        recognition.lang = languageSelect.value === 'ml' ? 'ml-IN' : 'en-US';

        recognition.onresult = (event) => {
          const transcript = event.results[0][0].transcript;
          userInput.value = transcript;
          handleMessage();
        };

        recognition.onerror = (event) => {
          console.error('Speech recognition error:', event.error);
          alert('Speech recognition failed. Please try again or type your message.');
        };

        recognition.start();
      } else {
        alert('Your browser does not support speech recognition. Please use Google Chrome or a similar browser.');
      }
    });

    // File Upload Integration (Simulated)
    fileUpload.addEventListener('change', (event) => {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (e) => {
          addMessage('Image uploaded successfully. Analyzing the image...', 'user');
          const imageUrl = e.target.result;
          // In a real app, this image would be sent to a backend for analysis.
          console.log('Image Data URL:', imageUrl);

          // SIMULATION: Simulating a response for an image upload
          setTimeout(() => {
            const language = languageSelect.value;
            const text = language === 'ml' ? "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥ö‡¥ø‡¥§‡µç‡¥∞‡¥Ç ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ö‡µç‡¥ö‡µÅ. ‡¥á‡¥§‡µç ‡¥µ‡¥æ‡¥¥‡¥Ø‡¥ø‡¥≤‡¥Ø‡¥ø‡¥≤‡µÜ ‡¥á‡¥≤‡¥™‡µç‡¥™‡µÅ‡¥≥‡µç‡¥≥‡¥ø ‡¥∞‡µã‡¥ó‡¥§‡µç‡¥§‡¥ø‡¥®‡µç‡¥±‡µÜ ‡¥≤‡¥ï‡µç‡¥∑‡¥£‡¥ô‡µç‡¥ô‡¥≥‡¥æ‡¥£‡µç. ‡¥á‡¥§‡¥ø‡¥®‡µç ‡¥ï‡µã‡¥™‡µç‡¥™‡µº ‡¥ì‡¥ï‡µç‡¥∏‡¥ø‡¥ï‡µç‡¥≤‡µã‡¥±‡µà‡¥°‡µç ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï." : "Image analyzed. It looks like leaf spot disease on a banana leaf. Use Copper Oxychloride to treat it.";
            addMessage(text, 'bot');
          }, 2000);
        };
        reader.readAsDataURL(file);
      }
    });
  </script>
</body>
</html>
